{"version":3,"sources":["utils/sleep.ts","maxflow/FordFulkerson.tsx","utils/index.tsx","components/flow/FlowArc.tsx","components/FlowNetworkEditor/FlowNetworkEditor.tsx","geometry/index.tsx","components/flow/FlowNode.tsx","components/FlowNetworkEditor/SmartButton.tsx","App.tsx","index.tsx"],"names":["sleep","ms","timeout","Math","max","Promise","resolve","setTimeout","findPath","a","node","visited","increase","newVisited","sink","path","dest","capacity","find","e","currentFlow","flow","arcIncrease","min","Object","entries","arcsWithBackward","arcs","source","onUpdate","keys","reduce","acc","to","from","augmentingPath","Infinity","i","length","b","forward","highligthedPath","asPixels","value","EDITOR_ACTIONS","useStyles","makeStyles","theme","arcLabel","position","top","color","palette","getContrastText","background","default","arrow","display","left","border","borderWidth","width","height","transform","borderColor","root","zIndex","textAlign","FlowArc","memo","props","rad","start","x","startX","y","startY","end","endX","endY","classes","sqrt","pow","pos","middle","orientation","atan","PI","angle","red","rgb","map","gCh","style","backgroundColor","join","className","grey","borderRadius","lineHeight","textTransform","lightBlue","label","spacing","FlowNode","selected","draggable","onClick","preventDefault","stopPropagation","id","onDrag","event","onDragStart","img","Image","src","dataTransfer","setDragImage","positionY","positionX","showName","SmartButton","disabled","otherProps","Button","variant","children","createUseStyles","canvas","useMUIStyles","primary","main","margin","grow","flexGrow","absoluteCoordinate","normalizedCoordinate","absolutePosition","normalizedPosition","window","innerWidth","innerHeight","relativePosition","reducer","state","action","type","ADD_NODE","newNode","payload","fixedSink","nodes","REMOVE_NODE","values","wasSink","wasSource","selectedNode","undefined","ADD_ARC","MOVE_NODE","SET_SOURCE","SET_SINK","SELECT_NODE","FlowNetworkEditor","useState","setFlow","useReducer","dispatch","dragHandler","useCallback","clientX","clientY","canvasClickHandler","Date","now","nodeClickHandler","useMemo","round","random","runClickHandler","then","fordFulkerson","deleteClickHandler","sourceMarkClickHandler","sinkMarkClickHandler","muiClasses","Bar","AppBar","Toolbar","ButtonGroup","startIcon","flat","createMuiTheme","secondary","App","ThemeProvider","CssBaseline","document","addEventListener","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.9ecae68a.chunk.js","sourcesContent":["export function sleep(ms: number) {\r\n    const timeout = Math.max(0, ms)\r\n    return new Promise(resolve => setTimeout(resolve, timeout))\r\n}","import { sleep } from \"../utils/sleep\"\r\n\r\ntype Arcs = { [from: string]: { [to: string]: number } }\r\n\r\n\r\ntype MaxFlowParams = {\r\n  source: string\r\n  sink: string\r\n  arcs: Arcs,\r\n  onUpdate?: (update: MaxFlowUpdate) => void\r\n}\r\n\r\ntype MaxFlowUpdate = {\r\n  highligthedPath?: string[],\r\n  flow: Arcs\r\n}\r\n\r\nexport async function fordFulkerson({\r\n  arcs,\r\n  source,\r\n  sink,\r\n  onUpdate = () => { }\r\n}: MaxFlowParams) {\r\n\r\n  const flow: Arcs = {}\r\n\r\n  const arcsWithBackward = Object.keys(arcs).reduce<Arcs>((acc, to) => {\r\n    for (const from of Object.keys(arcs[to])) {\r\n      if (!acc[from]) {\r\n        acc[from] = {}\r\n      }\r\n      if (!acc[to]) {\r\n        acc[to] = {}\r\n      }\r\n      acc[to][from] = arcs[to][from]\r\n      //mark backwards with negative capacity\r\n      acc[from][to] = -acc[to][from]\r\n    }\r\n    return acc\r\n  }, {})\r\n\r\n  function findPath(node: string, visited: string[], increase: number): { visited: string[], increase: number } | null {\r\n    const newVisited = [...visited, node]\r\n\r\n    if (node === sink) {\r\n      //we have arrived\r\n      return {\r\n        visited: newVisited,\r\n        increase\r\n      }\r\n    }\r\n\r\n    let path = null\r\n    for (const [dest, capacity] of Object.entries(arcsWithBackward[node] ?? {})) {\r\n\r\n      if (visited.find((e) => e === dest)) {\r\n        continue\r\n      }\r\n\r\n      const currentFlow = flow[node]?.[dest] ?? 0\r\n\r\n      //if capacity is negative we are looking at a backward arc\r\n      const arcIncrease = capacity >= 0 ? capacity - currentFlow : currentFlow\r\n\r\n      if (arcIncrease > 0) {\r\n        path = findPath(dest, newVisited, Math.min(increase, arcIncrease))\r\n        //we got a path\r\n        if (path) {\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    return path\r\n  }\r\n\r\n  let augmentingPath = findPath(source, [], Infinity)\r\n  while (augmentingPath) {\r\n    const visited = augmentingPath?.visited\r\n    for (let i = 0; i < visited.length - 1; i++) {\r\n      const [a, b] = [visited[i], visited[i + 1]]\r\n      if (!flow[a]) {\r\n        flow[a] = {}\r\n      }\r\n      //check if it was a backward arc\r\n      const forward = !!arcs[a][b]\r\n      const arcIncrease = augmentingPath.increase * (forward ? 1 : -1)\r\n\r\n      const [from, to] = forward ? [a, b] : [b, a]\r\n\r\n      if (!flow[from][to]) {\r\n        flow[from][to] = arcIncrease\r\n      } else {\r\n        flow[from][to] += arcIncrease\r\n      }\r\n    }\r\n    onUpdate({ highligthedPath: [...augmentingPath?.visited], flow: {...flow} })\r\n    augmentingPath = findPath(source, [], Infinity)\r\n    await sleep(1000)\r\n  }\r\n\r\n  return flow\r\n}","export function asPixels(value: number) {\n  return value + 'px'\n}\nexport function cssAngle(rad: number) {\n  return `rotate(${rad}rad)`\n}\n","import React, { memo } from 'react'\nimport { angle, distance, middle } from '../../geometry/index';\nimport { asPixels, cssAngle } from '../../utils/index';\nimport { makeStyles, Theme } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  arcLabel: {\n    position: 'absolute',\n    top: '10px',\n    color: theme.palette.getContrastText(theme.palette.background.default),\n  },\n  arrow: {\n    display: 'inline-block',\n    position: 'absolute',\n    top: '-2px',\n    left: '20px',\n    border: 'solid black',\n    borderWidth: ' 0 3px 3px 0',\n    width: '6px',\n    height: '6px',\n    transform: 'rotate(-45deg)',\n    borderColor: theme.palette.getContrastText(theme.palette.background.default),\n  },\n  root: {\n    position: 'absolute',\n    height: '6px',\n    zIndex: 1,\n    textAlign: 'center',\n  }\n})\n)\n\nexport const FlowArc = memo((props: {\n  startX: number,\n  startY: number,\n  endX: number,\n  endY: number,\n  capacity: number\n  flow: number\n}) => {\n\n  const start = { x: props.startX, y: props.startY }\n  const end = { x: props.endX, y: props.endY }\n  const classes = useStyles()\n  const { capacity, flow } = props\n  const length = distance(start, end)\n  const pos = middle(start, end)\n  const orientation = angle(start, end)\n\n  const green = [0, 255, 0]\n  const red = [255, 0, 0]\n  const rgb = green.map((gCh, i) => gCh + (red[i] - gCh) * flow / capacity)\n  const style = {\n    top: asPixels(pos.y),\n    left: asPixels(pos.x),\n    width: asPixels(length),\n    transform: `translateX(${-length / 2}px)` + cssAngle(orientation),\n    backgroundColor: `rgb(${rgb.join(',')})`\n  }\n\n  return <div className={classes.root} style={style}>\n    <i className={classes.arrow} />\n    <span className={classes.arcLabel}>{flow}/{capacity}</span>\n  </div>\n})","import { AppBar, ButtonGroup, makeStyles, Toolbar, Theme, } from \"@material-ui/core\";\n\nimport { useCallback, useMemo, useReducer, useState } from \"react\";\nimport { createUseStyles } from \"react-jss\";\nimport { Point } from \"../../geometry\";\nimport { fordFulkerson } from \"../../maxflow\";\nimport { FlowArc, FlowNetworkNode } from \"../flow\";\nimport { NodeId, NumericLabeledArcs } from \"../types\";\nimport { SmartButton } from \"./SmartButton\";\nimport FlagIcon from '@material-ui/icons/Flag';\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\";\nimport InputIcon from '@material-ui/icons/Input';\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nconst useStyles = createUseStyles({\n  canvas: {\n    width: '100%',\n    height: '100vh',\n  }\n})\n\nconst useMUIStyles = makeStyles((theme: Theme) => ({\n    root: {\n      backgroundColor: theme.palette.primary.main,\n      '& > *': {\n        margin: theme.spacing(1),\n      },\n    },\n    grow: {\n      flexGrow: 1,\n    },\n  })\n);\n\ntype NodeData = {\n  id: string,\n  position: Point,\n}\n\nfunction absoluteCoordinate(normalizedCoordinate: number, length: number) {\n  return (length + normalizedCoordinate * length) / 2\n}\nfunction normalizedCoordinate(absoluteCoordinate: number, length: number) {\n  return (absoluteCoordinate * 2 - length) / length\n}\n\nfunction absolutePosition(normalizedPosition: Point) {\n  return {\n    x: absoluteCoordinate(normalizedPosition.x, window.innerWidth),\n    y: absoluteCoordinate(normalizedPosition.y, window.innerHeight),\n  }\n}\n\nfunction relativePosition(absolutePosition: Point) {\n  return {\n    x: normalizedCoordinate(absolutePosition.x, window.innerWidth),\n    y: normalizedCoordinate(absolutePosition.y, window.innerHeight),\n  }\n}\n\nenum EDITOR_ACTIONS {\n  ADD_NODE,\n  REMOVE_NODE,\n  MOVE_NODE,\n  ADD_ARC,\n  SET_SOURCE,\n  SET_SINK,\n  SELECT_NODE\n}\n\ntype Action =\n  { type: EDITOR_ACTIONS.ADD_NODE, payload: NodeData }\n  | { type: EDITOR_ACTIONS.REMOVE_NODE, payload: NodeId }\n  | { type: EDITOR_ACTIONS.MOVE_NODE, payload: { id: NodeId, position: Point } }\n  | { type: EDITOR_ACTIONS.ADD_ARC, payload: { from: NodeId, to: NodeId, capacity: number } }\n  | { type: EDITOR_ACTIONS.SET_SOURCE, payload: NodeId | undefined }\n  | { type: EDITOR_ACTIONS.SET_SINK, payload: NodeId | undefined }\n  | { type: EDITOR_ACTIONS.SELECT_NODE, payload: NodeId }\n\n\ntype EditorState = {\n  nodes: { [id: string]: NodeData }\n  arcs: NumericLabeledArcs\n  flow: NumericLabeledArcs\n  source?: NodeId\n  sink?: NodeId\n  selectedNode?: NodeId\n  fixedSink: boolean,\n}\n\nfunction reducer(state: EditorState, action: Action): EditorState {\n  switch (action.type) {\n    case EDITOR_ACTIONS.ADD_NODE:\n      const newNode = action.payload\n      return {\n        ...state,\n        source: state.source ?? newNode.id,\n        sink: !state.source || state.fixedSink ? state.sink : newNode.id,\n        nodes: {\n          ...state.nodes,\n          [newNode.id]: newNode\n        }\n      }\n    case EDITOR_ACTIONS.REMOVE_NODE:\n      const { [action.payload]: deleted, ...nodes } = state.nodes\n      const { [action.payload]: arcsFromRemovedNode, ...arcs } = state.arcs\n\n      //remove the ingoing arcs to the node\n      for (const tos of Object.values(arcs)) {\n        delete tos[action.payload]\n      }\n      const wasSink = action.payload === state.sink\n      const wasSource = action.payload === state.sink\n      return {\n        ...state,\n        arcs,\n        nodes,\n        selectedNode: action.payload !== state.selectedNode ? state.selectedNode : undefined,\n        source: wasSource ? state.source : undefined,\n        sink: wasSink ? state.source : undefined,\n        fixedSink: wasSink ? false : state.fixedSink\n      }\n    case EDITOR_ACTIONS.ADD_ARC:\n      return {\n        ...state,\n        selectedNode: undefined,\n        arcs: {\n          ...state.arcs,\n          [action.payload.from]: {\n            ...state.arcs[action.payload.from],\n            [action.payload.to]: action.payload.capacity\n          }\n        },\n      }\n    case EDITOR_ACTIONS.MOVE_NODE:\n      return {\n        ...state,\n        nodes: {\n          ...state.nodes,\n          [action.payload.id]: {\n            ...state.nodes[action.payload.id],\n            position: action.payload.position\n          }\n        }\n      }\n    case EDITOR_ACTIONS.SET_SOURCE:\n      return {\n        ...state,\n        selectedNode: undefined,\n        source: action.payload\n      }\n    case EDITOR_ACTIONS.SET_SINK:\n      return {\n        ...state,\n        selectedNode: undefined,\n        sink: action.payload,\n        fixedSink: true\n      }\n    case EDITOR_ACTIONS.SELECT_NODE:\n      return {\n        ...state,\n        selectedNode: action.payload !== state.selectedNode ? action.payload : undefined\n      }\n    default:\n      return state\n\n  }\n}\n\nexport function FlowNetworkEditor() {\n\n  const [flow, setFlow] = useState<NumericLabeledArcs>({})\n\n  const [state, dispatch] = useReducer(reducer, {\n    nodes: {},\n    arcs: {},\n    flow: {},\n    fixedSink: false\n  })\n\n  const { sink, source, selectedNode } = state\n  const dragHandler = useCallback((id, event) => {\n\n    event.preventDefault()\n    const position = relativePosition({ x: event.clientX, y: event.clientY })\n\n    dispatch({\n      type: EDITOR_ACTIONS.MOVE_NODE,\n      payload: {\n        id,\n        position\n      }\n    })\n\n  }, [])\n\n  const canvasClickHandler = useCallback((e: React.MouseEvent) => {\n    dispatch({\n      type: EDITOR_ACTIONS.ADD_NODE,\n      payload: {\n        id: '' + Date.now(),\n        position: relativePosition({ x: e.clientX, y: e.clientY })\n      }\n    })\n  }, [])\n\n\n  const nodeClickHandler = useMemo(() => {\n    return (id: NodeId) => {\n\n      if (!selectedNode || id === selectedNode) {\n        dispatch({\n          type: EDITOR_ACTIONS.SELECT_NODE,\n          payload: id\n        })\n        return\n      }\n\n      //we add the new arc\n      if (!state.arcs[selectedNode]?.[id] && !state.arcs[id]?.[selectedNode]) {\n        dispatch({\n          type: EDITOR_ACTIONS.ADD_ARC,\n          payload: {\n            from: selectedNode,\n            to: id,\n            capacity: Math.round(8 * Math.random()) + 2\n          }\n        })\n      }\n    }\n  }, [selectedNode, state.arcs])\n\n  const runClickHandler = useMemo(() => {\n    return source && sink ? () => {\n      Promise.resolve()\n        .then(() => {\n          return fordFulkerson({\n            source,\n            sink,\n            arcs: state.arcs,\n            onUpdate: ({ flow, highligthedPath }) => {\n              setFlow(flow)\n            }\n          })\n        })\n        .then(setFlow)\n    } : undefined\n  }, [state.arcs, source, sink])\n\n  const deleteClickHandler = useMemo(() => {\n    return selectedNode ? () => {\n      //remove the node\n      dispatch({\n        type: EDITOR_ACTIONS.REMOVE_NODE,\n        payload: selectedNode,\n      })\n\n    } : undefined\n  },\n    [selectedNode])\n\n  const sourceMarkClickHandler = useMemo(() => {\n    return selectedNode && selectedNode !== sink ? () => {\n      dispatch({\n        type: EDITOR_ACTIONS.SET_SOURCE,\n        payload: selectedNode !== source ? selectedNode : undefined,\n      })\n    } : undefined\n  }, [selectedNode, sink, source])\n\n  const sinkMarkClickHandler = useMemo(() => {\n    return selectedNode && selectedNode !== source ? () => {\n      dispatch({\n        type: EDITOR_ACTIONS.SET_SINK,\n        payload: selectedNode !== sink ? selectedNode : undefined,\n      })\n    } : undefined\n  }, [selectedNode, sink, source])\n\n\n  const classes = useStyles()\n  const muiClasses = useMUIStyles()\n\n  const Bar = useMemo(() => <AppBar position=\"fixed\" color='primary' className={muiClasses.root}>\n    <Toolbar className={muiClasses.root} >\n      <div className={muiClasses.grow} />\n      <ButtonGroup variant='contained' >\n        <SmartButton onClick={sourceMarkClickHandler} startIcon={<InputIcon />}>{selectedNode === source ? 'Unm' : 'M'}ark as source</SmartButton>\n        <SmartButton onClick={sinkMarkClickHandler} startIcon={<FlagIcon />}>{selectedNode === sink ? 'Unm' : 'M'}ark as sink</SmartButton>\n        <SmartButton onClick={deleteClickHandler} startIcon={<DeleteIcon />}>Delete</SmartButton>\n      </ButtonGroup>\n      <SmartButton onClick={runClickHandler} color='secondary' variant='contained' startIcon={<PlayArrowIcon />}>Compute</SmartButton>\n    </Toolbar>\n  </AppBar>, [sourceMarkClickHandler, sinkMarkClickHandler, runClickHandler, deleteClickHandler, source, sink, selectedNode, muiClasses])\n\n  return <>\n    {Bar}\n    <div onClick={canvasClickHandler} className={classes.canvas}>\n      {\n        Object.values(state.nodes).map(node => {\n          const pos = absolutePosition(node.position)\n          return <FlowNetworkNode\n            key={node.id}\n            onDrag={dragHandler}\n            onClick={() => nodeClickHandler(node.id)}\n            {...node}\n            positionX={pos.x}\n            positionY={pos.y}\n            selected={node.id === selectedNode}\n            label={sink === node.id ? <FlagIcon /> : (source === node.id ? <PlayArrowIcon /> : undefined)}\n          />\n        })\n      }\n      {\n        Object.keys(state.arcs).map(from => Object.keys(state.arcs[from]).map(to => {\n          const start = absolutePosition(state.nodes[from].position)\n          const end = absolutePosition(state.nodes[to].position)\n\n          return <FlowArc\n            key={from + '-' + to}\n            flow={flow[from]?.[to] || 0}\n            capacity={state.arcs[from][to]}\n            startX={start.x}\n            startY={start.y}\n            endX={end.x}\n            endY={end.y}\n          />\n        })).flat()\n      }\n    </div>\n  </>\n\n}","\nexport type Point = {\n  x: number;\n  y: number;\n}\nexport type RectangleSize = {\n  width: number\n  height: number\n}\n\nfunction randomPoint(): Point {\n  function randomCoordinate() {\n    return -1 + Math.random() * 2\n  }\n  return { x: randomCoordinate(), y: randomCoordinate() }\n}\n\nfunction distance(a: Point, b: Point) {\n  return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2))\n}\n\nfunction middle(a: Point, b: Point) {\n  return {\n    x: (a.x + b.x) / 2,\n    y: (a.y + b.y) / 2,\n  }\n}\n\nfunction angle(a: Point, b: Point) {\n  return Math.atan((b.y - a.y) / (b.x - a.x)) + ( b.x < a.x ? Math.PI : 0)\n}\n\nfunction absolutePosition(position: Point): Point {\n  return {\n    x: 250 + position.x * 250,\n    y: 250 + position.y * 250\n  }\n}\n\nexport {\n  distance,\n  middle,\n  angle,\n  randomPoint,\n  absolutePosition\n}","import { makeStyles } from \"@material-ui/core\";\nimport { grey, lightBlue } from \"@material-ui/core/colors\";\nimport React, { DragEvent, memo } from \"react\"\n\nimport { asPixels } from '../../utils/index';\nimport { NodeId } from \"../types\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'absolute',\n    border: '6px solid ' + grey[600],\n    backgroundColor: theme.palette.background.default,\n    borderRadius: '50%',\n    height: '30px',\n    width: '30px',\n    lineHeight: '30px',\n    textAlign: 'center',\n    display: 'block',\n    textTransform: 'uppercase',\n    zIndex: 2,\n    transform: 'translate(-50%, -50%)',\n\n    '&.selected': {\n      borderColor: lightBlue[800]\n    }\n  },\n  label: {\n    position: 'absolute',\n    color: grey[600],\n    display: 'inline-block',\n    top: - theme.spacing(5),\n    left: '0px',\n  },\n}));\n\nexport const FlowNode = memo((props: {\n  id: NodeId\n  positionX: number,\n  positionY: number,\n  onClick: (id: NodeId) => void\n  onDrag: (id: NodeId, event: DragEvent) => void\n  selected?: boolean\n  label?: React.ReactNode\n  showName?: boolean\n}) => {\n  const classes = useStyles()\n\n  const dragStartHandler = (event: DragEvent) => {\n    var img = new Image();\n    img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=';\n    event.dataTransfer.setDragImage(img, 0, 0);\n  }\n  return (\n    <div\n      className={classes.root + (props.selected ? ' selected' : '')}\n      draggable={true}\n      onClick={(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        props.onClick(props.id)\n      }}\n      onDrag={(event) => props.onDrag(props.id, event)}\n      onDragStart={dragStartHandler}\n      style={\n        {\n          top: asPixels(props.positionY),\n          left: asPixels(props.positionX),\n        }}>\n      {props.showName ? props.id : null}\n      <span className={classes.label}>\n        {props.label}\n      </span>\n    </div>\n  )\n})\n\n\n","import { Button } from \"@material-ui/core\";\nimport { memo } from \"react\";\n\n\nexport const SmartButton = memo((props: React.ComponentProps<typeof Button>) => {\n    const {onClick, disabled, ...otherProps} = props\n    return <Button\n        variant='contained'\n        onClick={props.onClick}\n        disabled={!props.onClick}\n        {...otherProps}\n        >\n        {props.children}\n    </Button>\n})","import { createMuiTheme, CssBaseline, ThemeProvider } from '@material-ui/core';\nimport { grey } from '@material-ui/core/colors';\nimport './App.css'\nimport { FlowNetworkEditor } from './components/FlowNetworkEditor';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#006064',\n    },\n    secondary: {\n      main: '#afb42b',\n    },\n    background: {\n      default: grey[900]\n    }\n  },\n})\n\nfunction App() {\n  return (\n    <ThemeProvider theme={theme}>\n      <CssBaseline>\n        <FlowNetworkEditor />\n      </CssBaseline>\n    </ThemeProvider>\n  )\n}\n\nexport default App","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\ndocument.addEventListener('dragover', function (event) {\n\n  // prevent default to allow drop\n  event.preventDefault();\n\n}, false);\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}