(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{68:function(e,t,n){},69:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(2),o=n(0),c=n.n(o),r=n(19),i=n.n(r),s=(n(68),n(69),n(23)),d=n(29),l=n(51),u=n(18),b=n(4),O=n(99),j=n(103),p=n(101),f=n(102),v=n(42),y=n(47),x=n.n(y),h=n(50),m=n(55);function E(e){var t=Math.max(0,e);return new Promise((function(e){return setTimeout(e,t)}))}function k(){return(k=Object(m.a)(x.a.mark((function e(t){var n,a,o,c,r,i,d,l,u,O,j,p,f,v,y,m,k,D,g,N,A,w;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=function(e,t,n){var a=[].concat(Object(h.a)(t),[e]);if(e===o)return{visited:a,increase:n};for(var c=null,r=function(){var o,r,d=Object(s.a)(b[u],2),O=d[0],j=d[1];if(t.find((function(e){return e===O})))return"continue";var p=null!==(o=null===(r=i[e])||void 0===r?void 0:r[O])&&void 0!==o?o:0,f=j>=0?j-p:p;return f>0&&(c=l(O,a,Math.min(n,f)))?"break":void 0},u=0,b=Object.entries(null!==(O=d[e])&&void 0!==O?O:{});u<b.length;u++){var O,j=r();if("continue"!==j&&"break"===j)break}return c},n=t.arcs,a=t.source,o=t.sink,c=t.onUpdate,r=void 0===c?function(){}:c,i={},d=Object.keys(n).reduce((function(e,t){for(var a=0,o=Object.keys(n[t]);a<o.length;a++){var c=o[a];e[c]||(e[c]={}),e[t]||(e[t]={}),e[t][c]=n[t][c],e[c][t]=-e[t][c]}return e}),{}),u=l(a,[],1/0);case 5:if(!u){e.next=14;break}for(p=null===(O=u)||void 0===O?void 0:O.visited,f=0;f<p.length-1;f++)v=[p[f],p[f+1]],m=v[1],i[y=v[0]]||(i[y]={}),k=!!n[y][m],D=u.increase*(k?1:-1),g=k?[y,m]:[m,y],N=Object(s.a)(g,2),A=N[0],w=N[1],i[A][w]?i[A][w]+=D:i[A][w]=D;return r({highligthedPath:Object(h.a)(null===(j=u)||void 0===j?void 0:j.visited),flow:Object(b.a)({},i)}),u=l(a,[],1/0),e.next=12,E(1e3);case 12:e.next=5;break;case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return e+"px"}var g,N=Object(v.a)({arcLabel:{position:"absolute",top:"10px"},arrow:{display:"inline-block",position:"absolute",top:"-2px",left:"20px",border:"solid black",borderWidth:" 0 3px 3px 0",width:"6px",height:"6px",transform:"rotate(-45deg)"}}),A=Object(o.memo)((function(e){var t,n,o,c={x:e.startX,y:e.startY},r={x:e.endX,y:e.endY},i=N(),s=e.capacity,d=e.flow,l=(t=c,n=r,Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))),u=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}(c,r),b=function(e,t){return Math.atan((t.y-e.y)/(t.x-e.x))+(t.x<e.x?Math.PI:0)}(c,r),O=[255,0,0],j=[0,255,0].map((function(e,t){return e+(O[t]-e)*d/s})),p={top:D(u.y),left:D(u.x),width:D(l),transform:"translateX(".concat(-l/2,"px)")+(o=b,"rotate(".concat(o,"rad)")),backgroundColor:"rgb(".concat(j.join(","),")")};return Object(a.jsxs)("div",{className:"flow-arc",style:p,children:[Object(a.jsx)("i",{className:i.arrow}),Object(a.jsxs)("span",{className:i.arcLabel,children:[d,"/",s]})]})})),w=Object(O.a)((function(e){return{label:{display:"inline-block",marginTop:e.spacing(1)}}})),C=Object(o.memo)((function(e){var t=w();return Object(a.jsxs)("div",{className:"flow-node",draggable:!0,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.onClick(e.id)},onDrag:function(t){return e.onDrag(e.id,t)},onDragStart:function(e){var t=new Image;t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",e.dataTransfer.setDragImage(t,0,0)},style:{top:D(e.positionY),left:D(e.positionX),backgroundColor:e.bgColor},children:[e.id,Object(a.jsx)("span",{className:t.label,children:e.label})]})})),S=n(84),_=Object(o.memo)((function(e){e.onClick,e.disabled;var t=Object(d.a)(e,["onClick","disabled"]);return Object(a.jsx)(S.a,Object(b.a)(Object(b.a)({variant:"contained",onClick:e.onClick,disabled:!e.onClick},t),{},{children:e.children}))})),M=n(49),T=n.n(M),R=n(59),I=n.n(R),U=n(48),X=n.n(U),V=n(58),Y=n.n(V),L=Object(v.a)({canvas:{width:"100%",height:"100vh"}}),P=Object(O.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},grow:{flexGrow:1}}}));function B(e,t){return(t+e*t)/2}function K(e,t){return(2*e-t)/t}function Q(e){return{x:B(e.x,window.innerWidth),y:B(e.y,window.innerHeight)}}function W(e){return{x:K(e.x,window.innerWidth),y:K(e.y,window.innerHeight)}}function G(e,t){var n;switch(t.type){case g.ADD_NODE:var a=t.payload;return Object(b.a)(Object(b.a)({},e),{},{source:null!==(n=e.source)&&void 0!==n?n:a.id,sink:!e.source||e.fixedSink?e.sink:a.id,nodes:Object(b.a)(Object(b.a)({},e.nodes),{},Object(u.a)({},a.id,a))});case g.REMOVE_NODE:for(var o=e.nodes,c=t.payload,r=(o[c],Object(d.a)(o,[c].map(l.a))),i=e.arcs,s=t.payload,O=(i[s],Object(d.a)(i,[s].map(l.a))),j=0,p=Object.values(O);j<p.length;j++){delete p[j][t.payload]}var f=t.payload===e.sink,v=t.payload===e.sink;return Object(b.a)(Object(b.a)({},e),{},{arcs:O,nodes:r,selectedNode:t.payload!==e.selectedNode?e.selectedNode:void 0,source:v?e.source:void 0,sink:f?e.source:void 0,fixedSink:!f&&e.fixedSink});case g.ADD_ARC:return Object(b.a)(Object(b.a)({},e),{},{selectedNode:void 0,arcs:Object(b.a)(Object(b.a)({},e.arcs),{},Object(u.a)({},t.payload.from,Object(b.a)(Object(b.a)({},e.arcs[t.payload.from]),{},Object(u.a)({},t.payload.to,t.payload.capacity))))});case g.MOVE_NODE:return Object(b.a)(Object(b.a)({},e),{},{nodes:Object(b.a)(Object(b.a)({},e.nodes),{},Object(u.a)({},t.payload.id,Object(b.a)(Object(b.a)({},e.nodes[t.payload.id]),{},{position:t.payload.position})))});case g.SET_SOURCE:return Object(b.a)(Object(b.a)({},e),{},{selectedNode:void 0,source:t.payload});case g.SET_SINK:return Object(b.a)(Object(b.a)({},e),{},{selectedNode:void 0,sink:t.payload,fixedSink:!0});case g.SELECT_NODE:return Object(b.a)(Object(b.a)({},e),{},{selectedNode:t.payload!==e.selectedNode?t.payload:void 0});default:return e}}function H(){var e=Object(o.useState)({}),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(o.useReducer)(G,{nodes:{},arcs:{},flow:{},fixedSink:!1}),i=Object(s.a)(r,2),d=i[0],l=i[1],u=d.sink,O=d.source,v=d.selectedNode,y=Object(o.useCallback)((function(e,t){t.preventDefault();var n=W({x:t.clientX,y:t.clientY});l({type:g.MOVE_NODE,payload:{id:e,position:n}})}),[]),x=Object(o.useCallback)((function(e){l({type:g.ADD_NODE,payload:{id:""+Date.now(),position:W({x:e.clientX,y:e.clientY})}})}),[]),h=Object(o.useMemo)((function(){return function(e){var t,n;v&&e!==v?(null===(t=d.arcs[v])||void 0===t?void 0:t[e])||(null===(n=d.arcs[e])||void 0===n?void 0:n[v])||l({type:g.ADD_ARC,payload:{from:v,to:e,capacity:Math.round(8*Math.random())+2}}):l({type:g.SELECT_NODE,payload:e})}}),[v,d.arcs]),m=Object(o.useMemo)((function(){return O&&u?function(){Promise.resolve().then((function(){return function(e){return k.apply(this,arguments)}({source:O,sink:u,arcs:d.arcs,onUpdate:function(e){var t=e.flow;e.highligthedPath;c(t)}})})).then(c)}:void 0}),[d.arcs,O,u]),E=Object(o.useMemo)((function(){return v?function(){l({type:g.REMOVE_NODE,payload:v})}:void 0}),[v]),D=Object(o.useMemo)((function(){return v&&v!==u?function(){l({type:g.SET_SOURCE,payload:v!==O?v:void 0})}:void 0}),[v,u,O]),N=Object(o.useMemo)((function(){return v&&v!==O?function(){l({type:g.SET_SINK,payload:v!==u?v:void 0})}:void 0}),[v,u,O]),w=L(),S=P(),M=Object(o.useMemo)((function(){return Object(a.jsx)(j.a,{position:"fixed",children:Object(a.jsxs)(p.a,{className:S.root,children:[Object(a.jsx)("div",{className:S.grow}),Object(a.jsxs)(f.a,{variant:"contained",children:[Object(a.jsxs)(_,{onClick:D,startIcon:Object(a.jsx)(X.a,{}),children:[v===O?"Unm":"M","ark as source"]}),Object(a.jsxs)(_,{onClick:N,startIcon:Object(a.jsx)(T.a,{}),children:[v===u?"Unm":"M","ark as sink"]}),Object(a.jsx)(_,{onClick:E,startIcon:Object(a.jsx)(Y.a,{}),children:"Delete"})]}),Object(a.jsx)(_,{onClick:m,color:"primary",variant:"contained",startIcon:Object(a.jsx)(I.a,{}),children:"Compute"})]})})}),[D,N,m,E,O,u,v,S]);return Object(a.jsxs)(a.Fragment,{children:[M,Object(a.jsxs)("div",{onClick:x,className:w.canvas,children:[Object.values(d.nodes).map((function(e){var t=Q(e.position);return Object(a.jsx)(C,Object(b.a)(Object(b.a)({onDrag:y,onClick:function(){return h(e.id)}},e),{},{positionX:t.x,positionY:t.y,bgColor:e.id===v?"red":void 0,label:u===e.id?Object(a.jsx)(T.a,{}):O===e.id?Object(a.jsx)(X.a,{}):void 0}),e.id)})),Object.keys(d.arcs).map((function(e){return Object.keys(d.arcs[e]).map((function(t){var o,c=Q(d.nodes[e].position),r=Q(d.nodes[t].position);return Object(a.jsx)(A,{flow:(null===(o=n[e])||void 0===o?void 0:o[t])||0,capacity:d.arcs[e][t],startX:c.x,startY:c.y,endX:r.x,endY:r.y},e+"-"+t)}))})).flat()]})]})}!function(e){e[e.ADD_NODE=0]="ADD_NODE",e[e.REMOVE_NODE=1]="REMOVE_NODE",e[e.MOVE_NODE=2]="MOVE_NODE",e[e.ADD_ARC=3]="ADD_ARC",e[e.SET_SOURCE=4]="SET_SOURCE",e[e.SET_SINK=5]="SET_SINK",e[e.SELECT_NODE=6]="SELECT_NODE"}(g||(g={}));var J=function(){return Object(a.jsx)(H,{})};document.addEventListener("dragover",(function(e){e.preventDefault()}),!1),i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(J,{})}),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.19e8418b.chunk.js.map