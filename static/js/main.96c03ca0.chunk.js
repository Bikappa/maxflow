(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{22:function(t,e,n){},23:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n(0),r=n.n(a),c=n(15),o=n.n(c),u=(n(22),n(23),n(5)),s=n(4),d=n(2),l=n(12),b=n(10),j=n(9),f=n(14);function v(t){return t+"px"}var h=Object(j.a)({arcLabel:{position:"absolute",top:"10px"},arrow:{display:"inline-block",position:"absolute",top:"-2px",left:"20px",border:"solid black",borderWidth:" 0 3px 3px 0",width:"6px",height:"6px",transform:"rotate(-45deg)"}});function O(t){var e,n,a,r=h(),c=t.start,o=t.end,u=t.capacity,s=t.flow,d=(e=c,n=o,Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))),l=function(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}(c,o),b=function(t,e){return Math.atan((e.y-t.y)/(e.x-t.x))+(e.x<t.x?Math.PI:0)}(c,o),j=[255,0,0],f=[0,255,0].map((function(t,e){return t+(j[e]-t)*s/u})),O={top:v(l.y),left:v(l.x),width:v(d),transform:"translateX(".concat(-d/2,"px)")+(a=b,"rotate(".concat(a,"rad)")),backgroundColor:"rgb(".concat(f.join(","),")")};return Object(i.jsxs)("div",{className:"flow-arc",style:O,children:[Object(i.jsx)("i",{className:r.arrow}),Object(i.jsxs)("span",{className:r.arcLabel,children:[s,"/",u]})]})}function p(t){var e=t.id,n=t.position,a=t.onClick,r=t.onDrag;return Object(i.jsx)("div",{className:"flow-node",draggable:!0,onClick:function(t){t.preventDefault(),t.stopPropagation(),a(e)},onDrag:r,onDragStart:function(t){var e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",t.dataTransfer.setDragImage(e,0,0)},style:{top:v(n.y),left:v(n.x),backgroundColor:t.bgColor},children:e})}var g=Object(j.a)({canvas:{width:"100%",height:"100vh"}}),x=function t(e,n){Object(b.a)(this,t),this.id=void 0,this.value=void 0,this.id=e,this.value=n},y=function(){function t(){Object(b.a)(this,t),this._nodes={},this._adjacencyTable={}}return Object(l.a)(t,[{key:"addNode",value:function(t,e){if(t in this._nodes)throw new Error("Conflicting node id");this._nodes[t]=new x(t,e)}},{key:"addArc",value:function(t,e){this._adjacencyTable[t]||(this._adjacencyTable[t]={}),this._adjacencyTable[t][e]=!0}},{key:"getNodes",value:function(){return this._nodes}},{key:"getArcs",value:function(){return Object.entries(this._adjacencyTable).map((function(t){var e=Object(d.a)(t,2),n=e[0],i=e[1];return Object.entries(i).filter((function(t){return Object(d.a)(t,2)[1]})).map((function(t){var e=Object(d.a)(t,1)[0];return[n,e]}))})).flat()}}]),t}(),w=function(){function t(e,n){Object(b.a)(this,t),this.id=void 0,this.position=void 0,this.id=e,this.position=n}return Object(l.a)(t,[{key:"toString",value:function(){return this.id}}]),t}();function k(t,e){return(e+t*e)/2}function A(t,e){return(2*t-e)/e}function m(t){return{x:k(t.x,window.innerWidth),y:k(t.y,window.innerHeight)}}function C(t){return{x:A(t.x,window.innerWidth),y:A(t.y,window.innerHeight)}}function D(){var t=Object(a.useState)({}),e=Object(d.a)(t,2),n=e[0],r=e[1],c=Object(a.useState)({}),o=Object(d.a)(c,2),l=o[0],b=o[1],j=Object(a.useState)({}),v=Object(d.a)(j,2),h=v[0],x=v[1],k=Object(a.useState)(10),A=(Object(d.a)(k,1)[0],Object(a.useState)(void 0)),D=Object(d.a)(A,2),M=D[0],N=D[1],S=new y;Object.values(n).forEach((function(t){S.addNode(t.id,new w(t.id,t.position))}));for(var _=0,T=Object.entries(l);_<T.length;_++)for(var B=Object(d.a)(T[_],2),E=B[0],I=B[1],L=0,P=Object.entries(I);L<P.length;L++){var Q=Object(d.a)(P[L],1)[0];S.addArc(E,Q)}var W=Object(a.useCallback)((function(t,e){e.preventDefault();var n=C({x:e.clientX,y:e.clientY});r((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},t,{id:t,position:n}))}))}),[r]),X=Object(a.useCallback)((function(t){r((function(e){var n={id:""+Object.keys(e).length,position:C({x:t.clientX,y:t.clientY})};return Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},n.id,n))}))}),[r]),H=M?function(t){t!==M&&b((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},M,Object(s.a)(Object(s.a)({},e[M]),{},Object(u.a)({},t,Math.round(8*Math.random())+2))))})),N(void 0)}:N,J=g(),R=S.getNodes();return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("header",{children:Object(i.jsx)("button",{onClick:function(){new Promise((function(t){t(function(t,e,n){var i={},a=Object.keys(n).reduce((function(t,e){for(var i=0,a=Object.keys(n[e]);i<a.length;i++){var r=a[i];t[r]||(t[r]=new Set),t[r].add(e)}return t}),{});function r(t,c,o){var u=[].concat(Object(f.a)(c),[t]);if(t===e)return{visited:u,increase:o};for(var s=null,l=function(){var e,n,a=Object(d.a)(j[b],2),l=a[0],f=a[1];if(c.find((function(t){return t===l})))return"continue";var v=f-(null!==(e=null===(n=i[t])||void 0===n?void 0:n[l])&&void 0!==e?e:0);return v>0&&(s=r(l,u,Math.min(o,v)))?"break":void 0},b=0,j=Object.entries(null!==(v=n[t])&&void 0!==v?v:{});b<j.length;b++){var v,h=l();if("continue"!==h&&"break"===h)break}if(!s)for(var O=function(){var e,n,a=g[p];if(c.find((function(t){return t===a})))return"continue";var d=null!==(e=null===(n=i[t])||void 0===n?void 0:n[a])&&void 0!==e?e:0;return d>0&&(s=r(a,u,Math.min(o,d)))?"break":void 0},p=0,g=Object(f.a)(null!==(x=a[t])&&void 0!==x?x:[]);p<g.length;p++){var x,y=O();if("continue"!==y&&"break"===y)break}return s}for(var c=r(t,[],1/0);c;){for(var o,u=null===(o=c)||void 0===o?void 0:o.visited,s=0;s<u.length-1;s++){var l=[u[s],u[s+1]],b=l[0],j=l[1];i[b]||(i[b]={});var v=c.increase*(n[b][j]?1:-1);i[b][j]?i[b][j]+=v:i[b][j]=v}c=r(t,[],1/0)}return i}("0",""+(Object.keys(n).length-1),l))})).then(x)},children:"Run"})}),Object(i.jsxs)("div",{onClick:X,className:J.canvas,children:[Object.values(R).map((function(t){var e=t.value;return Object(i.jsx)(p,Object(s.a)(Object(s.a)({onDrag:function(t){return W(e.id,t)},onClick:H},e),{},{position:m(e.position),bgColor:e.id===M?"red":void 0}),e.id)})),S.getArcs().map((function(t){var e,n=Object(d.a)(t,2),a=n[0],r=n[1];return Object(i.jsx)(O,{flow:(null===(e=h[a])||void 0===e?void 0:e[r])||0,capacity:l[a][r],start:m(R[a].value.position),end:m(R[r].value.position)},a+"-"+r)}))]})]})}var M=function(){return Object(i.jsx)(D,{})};document.addEventListener("dragover",(function(t){t.preventDefault()}),!1),o.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(M,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.96c03ca0.chunk.js.map