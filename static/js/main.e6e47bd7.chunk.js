(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{57:function(t,e,n){},58:function(t,e,n){},68:function(t,e,n){"use strict";n.r(e);var i=n(3),a=n(0),c=n.n(a),o=n(19),r=n.n(o),s=(n(57),n(58),n(27)),d=n(42),l=n(18),u=n(11),b=n(8),j=n(40),v=n(38),O=n(88),f=n(92),h=n(89),p=n(90),x=n(91),g=n(21),y=n(47);function k(t){return t+"px"}var m=Object(g.a)({arcLabel:{position:"absolute",top:"10px"},arrow:{display:"inline-block",position:"absolute",top:"-2px",left:"20px",border:"solid black",borderWidth:" 0 3px 3px 0",width:"6px",height:"6px",transform:"rotate(-45deg)"}});function w(t){var e,n,a,c={x:t.startX,y:t.startY},o={x:t.endX,y:t.endY},r=m(),s=t.capacity,d=t.flow,l=(e=c,n=o,Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))),u=function(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}(c,o),b=function(t,e){return Math.atan((e.y-t.y)/(e.x-t.x))+(e.x<t.x?Math.PI:0)}(c,o),j=[255,0,0],v=[0,255,0].map((function(t,e){return t+(j[e]-t)*d/s})),O={top:k(u.y),left:k(u.x),width:k(l),transform:"translateX(".concat(-l/2,"px)")+(a=b,"rotate(".concat(a,"rad)")),backgroundColor:"rgb(".concat(v.join(","),")")};return Object(i.jsxs)("div",{className:"flow-arc",style:O,children:[Object(i.jsx)("i",{className:r.arrow}),Object(i.jsxs)("span",{className:r.arcLabel,children:[d,"/",s]})]})}var A=Object(g.a)({label:{position:"absolute",top:"-2em"}}),C=Object(a.memo)((function(t){var e=A();return Object(i.jsxs)("div",{className:"flow-node",draggable:!0,onClick:function(e){e.preventDefault(),e.stopPropagation(),t.onClick(t.id)},onDrag:function(e){return t.onDrag(t.id,e)},onDragStart:function(t){var e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",t.dataTransfer.setDragImage(e,0,0)},style:{top:k(t.positionY),left:k(t.positionX),backgroundColor:t.bgColor},children:[t.id,t.label?Object(i.jsx)("span",{className:e.label,children:t.label}):null]})})),N=n(69);function D(t){t.onClick,t.disabled;var e=Object(s.a)(t,["onClick","disabled"]);return Object(i.jsx)(N.a,Object(u.a)(Object(u.a)({variant:"contained",onClick:t.onClick,disabled:!t.onClick},e),{},{children:t.children}))}var M=Object(g.a)({canvas:{width:"100%",height:"100vh"}}),S=Object(O.a)((function(t){return{root:{"& > *":{margin:t.spacing(1)}},grow:{flexGrow:1}}})),X=function t(e,n){Object(v.a)(this,t),this.id=void 0,this.value=void 0,this.id=e,this.value=n},_=function(){function t(){Object(v.a)(this,t),this._nodes={},this._adjacencyTable={}}return Object(j.a)(t,[{key:"addNode",value:function(t,e){if(t in this._nodes)throw new Error("Conflicting node id");this._nodes[t]=new X(t,e)}},{key:"addArc",value:function(t,e){this._adjacencyTable[t]||(this._adjacencyTable[t]={}),this._adjacencyTable[t][e]=!0}},{key:"getNodes",value:function(){return this._nodes}},{key:"getArcs",value:function(){return Object.entries(this._adjacencyTable).map((function(t){var e=Object(b.a)(t,2),n=e[0],i=e[1];return Object.entries(i).filter((function(t){return Object(b.a)(t,2)[1]})).map((function(t){var e=Object(b.a)(t,1)[0];return[n,e]}))})).flat()}}]),t}(),Y=function(){function t(e,n){Object(v.a)(this,t),this.id=void 0,this.position=void 0,this.id=e,this.position=n}return Object(j.a)(t,[{key:"toString",value:function(){return this.id}}]),t}();function I(t,e){return(e+t*e)/2}function T(t,e){return(2*t-e)/e}function B(t){return{x:I(t.x,window.innerWidth),y:I(t.y,window.innerHeight)}}function E(t){return{x:T(t.x,window.innerWidth),y:T(t.y,window.innerHeight)}}function L(){var t=S(),e=Object(a.useState)({}),n=Object(b.a)(e,2),c=n[0],o=n[1],r=Object(a.useState)({}),j=Object(b.a)(r,2),v=j[0],O=j[1],g=Object(a.useState)({}),k=Object(b.a)(g,2),m=k[0],A=k[1],N=Object(a.useState)(void 0),X=Object(b.a)(N,2),I=X[0],T=X[1],L=Object(a.useState)(void 0),P=Object(b.a)(L,2),Q=P[0],U=P[1],W=Object(a.useState)(10),G=(Object(b.a)(W,1)[0],Object(a.useState)(void 0)),H=Object(b.a)(G,2),J=H[0],q=H[1],F=new _;Object.values(c).forEach((function(t){F.addNode(t.id,new Y(t.id,t.position))}));for(var R=0,z=Object.entries(v);R<z.length;R++)for(var K=Object(b.a)(z[R],2),V=K[0],Z=K[1],$=0,tt=Object.entries(Z);$<tt.length;$++){var et=Object(b.a)(tt[$],1)[0];F.addArc(V,et)}var nt=Object(a.useCallback)((function(t,e){e.preventDefault();var n=E({x:e.clientX,y:e.clientY});o((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(l.a)({},t,{id:t,position:n}))}))}),[o]),it=Object(a.useCallback)((function(t){o((function(e){var n={id:""+Object.keys(e).length,position:E({x:t.clientX,y:t.clientY})};return Object(u.a)(Object(u.a)({},e),{},Object(l.a)({},n.id,n))}))}),[o]),at=Object(a.useCallback)((function(t){var e,n;J?(t===J||(null===(e=v[J])||void 0===e?void 0:e[t])||(null===(n=v[t])||void 0===n?void 0:n[J])||O((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(l.a)({},J,Object(u.a)(Object(u.a)({},e[J]),{},Object(l.a)({},t,Math.round(8*Math.random())+2))))})),q(void 0)):q(t)}),[J,q,v,O]),ct=I&&Q?function(){new Promise((function(t){t(function(t,e,n){var i={},a=Object.keys(n).reduce((function(t,e){for(var i=0,a=Object.keys(n[e]);i<a.length;i++){var c=a[i];t[c]||(t[c]={}),t[e]||(t[e]={}),t[e][c]=n[e][c],t[c][e]=-t[e][c]}return t}),{});function c(t,n,o){var r=[].concat(Object(y.a)(n),[t]);if(t===e)return{visited:r,increase:o};for(var s=null,d=function(){var e,a,d=Object(b.a)(u[l],2),j=d[0],v=d[1];if(n.find((function(t){return t===j})))return"continue";var O=null!==(e=null===(a=i[t])||void 0===a?void 0:a[j])&&void 0!==e?e:0,f=v>=0?v-O:O;return f>0&&(s=c(j,r,Math.min(o,f)))?"break":void 0},l=0,u=Object.entries(null!==(j=a[t])&&void 0!==j?j:{});l<u.length;l++){var j,v=d();if("continue"!==v&&"break"===v)break}return s}for(var o=c(t,[],1/0);o;){for(var r,s=null===(r=o)||void 0===r?void 0:r.visited,d=0;d<s.length-1;d++){var l=[s[d],s[d+1]],u=l[0],j=l[1];i[u]||(i[u]={});var v=!!n[u][j],O=o.increase*(v?1:-1),f=v?[u,j]:[j,u],h=Object(b.a)(f,2),p=h[0],x=h[1];i[p][x]?i[p][x]+=O:i[p][x]=O}o=c(t,[],1/0)}return i}(I,Q,v))})).then(A)}:void 0,ot=J?function(){I===J&&T(void 0),Q===J&&U(void 0),q(void 0);v[J];for(var t=Object(s.a)(v,[J].map(d.a)),e=0,n=Object.values(t);e<n.length;e++){delete n[e][J]}O(t);c[J];var i=Object(s.a)(c,[J].map(d.a));o(i)}:void 0,rt=J&&J!==Q?function(){T(J===I?void 0:J),q(void 0)}:void 0,st=J&&J!==I?function(){U(J===Q?void 0:J),q(void 0)}:void 0,dt=M(),lt=F.getNodes();return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(f.a,{position:"fixed",children:Object(i.jsxs)(h.a,{className:t.root,children:[Object(i.jsx)("div",{className:t.grow}),Object(i.jsxs)(p.a,{variant:"contained",children:[Object(i.jsxs)(D,{onClick:rt,children:[J===I?"Unm":"M","ark as source"]}),Object(i.jsxs)(D,{onClick:st,children:[J===Q?"Unm":"M","ark as sink"]}),Object(i.jsx)(D,{onClick:ot,children:"Delete"})]}),Object(i.jsx)(D,{onClick:ct,color:"primary",variant:"contained",startIcon:Object(i.jsx)(x.a,{}),children:"Compute"})]})}),Object(i.jsxs)("div",{onClick:it,className:dt.canvas,children:[Object.values(lt).map((function(t){var e=t.value,n=B(e.position);return Object(i.jsx)(C,Object(u.a)(Object(u.a)({onDrag:nt,onClick:at},e),{},{positionX:n.x,positionY:n.y,bgColor:e.id===J?"red":void 0,label:Q===e.id?"sink":I===e.id?"source":void 0}),e.id)})),F.getArcs().map((function(t){var e,n=Object(b.a)(t,2),a=n[0],c=n[1],o=B(lt[a].value.position),r=B(lt[c].value.position);return Object(i.jsx)(w,{flow:(null===(e=m[a])||void 0===e?void 0:e[c])||0,capacity:v[a][c],startX:o.x,startY:o.y,endX:r.x,endY:r.y},a+"-"+c)}))]})]})}var P=function(){return Object(i.jsx)(L,{})};document.addEventListener("dragover",(function(t){t.preventDefault()}),!1),r.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(P,{})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.e6e47bd7.chunk.js.map