(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{73:function(e,t,n){},74:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var a=n(2),o=n(0),c=n.n(o),r=n(19),i=n.n(r),s=(n(73),n(63)),d=n(110),l=n(111),u=n(47),b=(n(74),n(23)),j=n(29),p=n(54),O=n(18),f=n(4),x=n(105),v=n(112),y=n(108),h=n(109),m=n(64),k=n(50),E=n.n(k),g=n(53),D=n(58);function N(e){var t=Math.max(0,e);return new Promise((function(e){return setTimeout(e,t)}))}function A(){return(A=Object(D.a)(E.a.mark((function e(t){var n,a,o,c,r,i,s,d,l,u,j,p,O,x,v,y,h,m,k,D,A,C;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d=function(e,t,n){var a=[].concat(Object(g.a)(t),[e]);if(e===o)return{visited:a,increase:n};for(var c=null,r=function(){var o,r,s=Object(b.a)(u[l],2),j=s[0],p=s[1];if(t.find((function(e){return e===j})))return"continue";var O=null!==(o=null===(r=i[e])||void 0===r?void 0:r[j])&&void 0!==o?o:0,f=p>=0?p-O:O;return f>0&&(c=d(j,a,Math.min(n,f)))?"break":void 0},l=0,u=Object.entries(null!==(j=s[e])&&void 0!==j?j:{});l<u.length;l++){var j,p=r();if("continue"!==p&&"break"===p)break}return c},n=t.arcs,a=t.source,o=t.sink,c=t.onUpdate,r=void 0===c?function(){}:c,i={},s=Object.keys(n).reduce((function(e,t){for(var a=0,o=Object.keys(n[t]);a<o.length;a++){var c=o[a];e[c]||(e[c]={}),e[t]||(e[t]={}),e[t][c]=n[t][c],e[c][t]=-e[t][c]}return e}),{}),l=d(a,[],1/0);case 5:if(!l){e.next=14;break}for(p=null===(u=l)||void 0===u?void 0:u.visited,O=0;O<p.length-1;O++)x=[p[O],p[O+1]],y=x[1],i[v=x[0]]||(i[v]={}),h=!!n[v][y],m=l.increase*(h?1:-1),k=h?[v,y]:[y,v],D=Object(b.a)(k,2),A=D[0],C=D[1],i[A][C]?i[A][C]+=m:i[A][C]=m;return r({highligthedPath:Object(g.a)(null===(j=l)||void 0===j?void 0:j.visited),flow:Object(f.a)({},i)}),l=d(a,[],1/0),e.next=12,N(1e3);case 12:e.next=5;break;case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return e+"px"}var w,S=Object(x.a)((function(e){return{arcLabel:{position:"absolute",top:"10px",color:e.palette.getContrastText(e.palette.background.default)},arrow:{display:"inline-block",position:"absolute",top:"-2px",left:"20px",border:"solid black",borderWidth:" 0 3px 3px 0",width:"6px",height:"6px",transform:"rotate(-45deg)",borderColor:e.palette.getContrastText(e.palette.background.default)},root:{position:"absolute",height:"6px",zIndex:1,textAlign:"center"}}})),_=Object(o.memo)((function(e){var t,n,o,c={x:e.startX,y:e.startY},r={x:e.endX,y:e.endY},i=S(),s=e.capacity,d=e.flow,l=(t=c,n=r,Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))),u=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}(c,r),b=function(e,t){return Math.atan((t.y-e.y)/(t.x-e.x))+(t.x<e.x?Math.PI:0)}(c,r),j=[255,0,0],p=[0,255,0].map((function(e,t){return e+(j[t]-e)*d/s})),O={top:C(u.y),left:C(u.x),width:C(l),transform:"translateX(".concat(-l/2,"px)")+(o=b,"rotate(".concat(o,"rad)")),backgroundColor:"rgb(".concat(p.join(","),")")};return Object(a.jsxs)("div",{className:i.root,style:O,children:[Object(a.jsx)("i",{className:i.arrow}),Object(a.jsxs)("span",{className:i.arcLabel,children:[d,"/",s]})]})})),M=n(107),T=Object(x.a)((function(e){return{root:{position:"absolute",border:"6px solid "+u.a[600],backgroundColor:e.palette.background.default,borderRadius:"50%",height:"30px",width:"30px",lineHeight:"30px",textAlign:"center",display:"block",textTransform:"uppercase",zIndex:2,transform:"translate(-50%, -50%)","&.selected":{borderColor:M.a[800]}},label:{position:"absolute",color:u.a[600],display:"inline-block",top:-e.spacing(5),left:"0px"}}})),I=Object(o.memo)((function(e){var t=T();return Object(a.jsxs)("div",{className:t.root+(e.selected?" selected":""),draggable:!0,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.onClick(e.id)},onDrag:function(t){return e.onDrag(e.id,t)},onDragStart:function(e){var t=new Image;t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",e.dataTransfer.setDragImage(t,0,0)},style:{top:C(e.positionY),left:C(e.positionX)},children:[e.showName?e.id:null,Object(a.jsx)("span",{className:t.label,children:e.label})]})})),R=n(90),U=Object(o.memo)((function(e){e.onClick,e.disabled;var t=Object(j.a)(e,["onClick","disabled"]);return Object(a.jsx)(R.a,Object(f.a)(Object(f.a)({variant:"contained",onClick:e.onClick,disabled:!e.onClick},t),{},{children:e.children}))})),X=n(51),V=n.n(X),Y=n(52),L=n.n(Y),P=n(61),B=n.n(P),K=n(62),H=n.n(K),Q=Object(m.a)({canvas:{width:"100%",height:"100vh"}}),W=Object(x.a)((function(e){return{root:{backgroundColor:e.palette.primary.main,"& > *":{margin:e.spacing(1)}},grow:{flexGrow:1}}}));function z(e,t){return(t+e*t)/2}function G(e,t){return(2*e-t)/t}function J(e){return{x:z(e.x,window.innerWidth),y:z(e.y,window.innerHeight)}}function q(e){return{x:G(e.x,window.innerWidth),y:G(e.y,window.innerHeight)}}function F(e,t){var n;switch(t.type){case w.ADD_NODE:var a=t.payload;return Object(f.a)(Object(f.a)({},e),{},{source:null!==(n=e.source)&&void 0!==n?n:a.id,sink:!e.source||e.fixedSink?e.sink:a.id,nodes:Object(f.a)(Object(f.a)({},e.nodes),{},Object(O.a)({},a.id,a))});case w.REMOVE_NODE:for(var o=e.nodes,c=t.payload,r=(o[c],Object(j.a)(o,[c].map(p.a))),i=e.arcs,s=t.payload,d=(i[s],Object(j.a)(i,[s].map(p.a))),l=0,u=Object.values(d);l<u.length;l++){delete u[l][t.payload]}var b=t.payload===e.sink,x=t.payload===e.sink;return Object(f.a)(Object(f.a)({},e),{},{arcs:d,nodes:r,selectedNode:t.payload!==e.selectedNode?e.selectedNode:void 0,source:x?e.source:void 0,sink:b?e.source:void 0,fixedSink:!b&&e.fixedSink});case w.ADD_ARC:return Object(f.a)(Object(f.a)({},e),{},{selectedNode:void 0,arcs:Object(f.a)(Object(f.a)({},e.arcs),{},Object(O.a)({},t.payload.from,Object(f.a)(Object(f.a)({},e.arcs[t.payload.from]),{},Object(O.a)({},t.payload.to,t.payload.capacity))))});case w.MOVE_NODE:return Object(f.a)(Object(f.a)({},e),{},{nodes:Object(f.a)(Object(f.a)({},e.nodes),{},Object(O.a)({},t.payload.id,Object(f.a)(Object(f.a)({},e.nodes[t.payload.id]),{},{position:t.payload.position})))});case w.SET_SOURCE:return Object(f.a)(Object(f.a)({},e),{},{selectedNode:void 0,source:t.payload});case w.SET_SINK:return Object(f.a)(Object(f.a)({},e),{},{selectedNode:void 0,sink:t.payload,fixedSink:!0});case w.SELECT_NODE:return Object(f.a)(Object(f.a)({},e),{},{selectedNode:t.payload!==e.selectedNode?t.payload:void 0});default:return e}}function Z(){var e=Object(o.useState)({}),t=Object(b.a)(e,2),n=t[0],c=t[1],r=Object(o.useReducer)(F,{nodes:{},arcs:{},flow:{},fixedSink:!1}),i=Object(b.a)(r,2),s=i[0],d=i[1],l=s.sink,u=s.source,j=s.selectedNode,p=Object(o.useCallback)((function(e,t){t.preventDefault();var n=q({x:t.clientX,y:t.clientY});d({type:w.MOVE_NODE,payload:{id:e,position:n}})}),[]),O=Object(o.useCallback)((function(e){d({type:w.ADD_NODE,payload:{id:""+Date.now(),position:q({x:e.clientX,y:e.clientY})}})}),[]),x=Object(o.useMemo)((function(){return function(e){var t,n;j&&e!==j?(null===(t=s.arcs[j])||void 0===t?void 0:t[e])||(null===(n=s.arcs[e])||void 0===n?void 0:n[j])||d({type:w.ADD_ARC,payload:{from:j,to:e,capacity:Math.round(8*Math.random())+2}}):d({type:w.SELECT_NODE,payload:e})}}),[j,s.arcs]),m=Object(o.useMemo)((function(){return u&&l?function(){Promise.resolve().then((function(){return function(e){return A.apply(this,arguments)}({source:u,sink:l,arcs:s.arcs,onUpdate:function(e){var t=e.flow;e.highligthedPath;c(t)}})})).then(c)}:void 0}),[s.arcs,u,l]),k=Object(o.useMemo)((function(){return j?function(){d({type:w.REMOVE_NODE,payload:j})}:void 0}),[j]),E=Object(o.useMemo)((function(){return j&&j!==l?function(){d({type:w.SET_SOURCE,payload:j!==u?j:void 0})}:void 0}),[j,l,u]),g=Object(o.useMemo)((function(){return j&&j!==u?function(){d({type:w.SET_SINK,payload:j!==l?j:void 0})}:void 0}),[j,l,u]),D=Q(),N=W(),C=Object(o.useMemo)((function(){return Object(a.jsx)(v.a,{position:"fixed",color:"primary",className:N.root,children:Object(a.jsxs)(y.a,{className:N.root,children:[Object(a.jsx)("div",{className:N.grow}),Object(a.jsxs)(h.a,{variant:"contained",children:[Object(a.jsxs)(U,{onClick:E,startIcon:Object(a.jsx)(B.a,{}),children:[j===u?"Unm":"M","ark as source"]}),Object(a.jsxs)(U,{onClick:g,startIcon:Object(a.jsx)(V.a,{}),children:[j===l?"Unm":"M","ark as sink"]}),Object(a.jsx)(U,{onClick:k,startIcon:Object(a.jsx)(H.a,{}),children:"Delete"})]}),Object(a.jsx)(U,{onClick:m,color:"secondary",variant:"contained",startIcon:Object(a.jsx)(L.a,{}),children:"Compute"})]})})}),[E,g,m,k,u,l,j,N]);return Object(a.jsxs)(a.Fragment,{children:[C,Object(a.jsxs)("div",{onClick:O,className:D.canvas,children:[Object.values(s.nodes).map((function(e){var t=J(e.position);return Object(a.jsx)(I,Object(f.a)(Object(f.a)({onDrag:p,onClick:function(){return x(e.id)}},e),{},{positionX:t.x,positionY:t.y,selected:e.id===j,label:l===e.id?Object(a.jsx)(V.a,{}):u===e.id?Object(a.jsx)(L.a,{}):void 0}),e.id)})),Object.keys(s.arcs).map((function(e){return Object.keys(s.arcs[e]).map((function(t){var o,c=J(s.nodes[e].position),r=J(s.nodes[t].position);return Object(a.jsx)(_,{flow:(null===(o=n[e])||void 0===o?void 0:o[t])||0,capacity:s.arcs[e][t],startX:c.x,startY:c.y,endX:r.x,endY:r.y},e+"-"+t)}))})).flat()]})]})}!function(e){e[e.ADD_NODE=0]="ADD_NODE",e[e.REMOVE_NODE=1]="REMOVE_NODE",e[e.MOVE_NODE=2]="MOVE_NODE",e[e.ADD_ARC=3]="ADD_ARC",e[e.SET_SOURCE=4]="SET_SOURCE",e[e.SET_SINK=5]="SET_SINK",e[e.SELECT_NODE=6]="SELECT_NODE"}(w||(w={}));var $=Object(s.a)({palette:{primary:{main:"#006064"},secondary:{main:"#afb42b"},background:{default:u.a[900]}}});var ee=function(){return Object(a.jsx)(d.a,{theme:$,children:Object(a.jsx)(l.a,{children:Object(a.jsx)(Z,{})})})};document.addEventListener("dragover",(function(e){e.preventDefault()}),!1),i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(ee,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.9ecae68a.chunk.js.map