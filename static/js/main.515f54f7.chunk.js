(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{24:function(t,e,n){},25:function(t,e,n){},33:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n(0),c=n.n(a),o=n(16),r=n.n(o),s=(n(24),n(25),n(15)),u=n(14),d=n(5),l=n(4),b=n(2),j=n(12),v=n(10),f=n(6),O=n(18);function h(t){return t+"px"}var p=Object(f.a)({arcLabel:{position:"absolute",top:"10px"},arrow:{display:"inline-block",position:"absolute",top:"-2px",left:"20px",border:"solid black",borderWidth:" 0 3px 3px 0",width:"6px",height:"6px",transform:"rotate(-45deg)"}});function x(t){var e,n,a,c=p(),o=t.start,r=t.end,s=t.capacity,u=t.flow,d=(e=o,n=r,Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))),l=function(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}(o,r),b=function(t,e){return Math.atan((e.y-t.y)/(e.x-t.x))+(e.x<t.x?Math.PI:0)}(o,r),j=[255,0,0],v=[0,255,0].map((function(t,e){return t+(j[e]-t)*u/s})),f={top:h(l.y),left:h(l.x),width:h(d),transform:"translateX(".concat(-d/2,"px)")+(a=b,"rotate(".concat(a,"rad)")),backgroundColor:"rgb(".concat(v.join(","),")")};return Object(i.jsxs)("div",{className:"flow-arc",style:f,children:[Object(i.jsx)("i",{className:c.arrow}),Object(i.jsxs)("span",{className:c.arcLabel,children:[u,"/",s]})]})}var g=Object(f.a)({label:{position:"absolute",top:"-2em"}});function y(t){var e=g();return Object(i.jsxs)("div",{className:"flow-node",draggable:!0,onClick:function(e){e.preventDefault(),e.stopPropagation(),t.onClick(t.id)},onDrag:t.onDrag,onDragStart:function(t){var e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",t.dataTransfer.setDragImage(e,0,0)},style:{top:h(t.position.y),left:h(t.position.x),backgroundColor:t.bgColor},children:[t.id,t.label?Object(i.jsx)("span",{className:e.label,children:t.label}):null]})}var k=Object(f.a)({canvas:{width:"100%",height:"100vh"}}),m=function t(e,n){Object(v.a)(this,t),this.id=void 0,this.value=void 0,this.id=e,this.value=n},w=function(){function t(){Object(v.a)(this,t),this._nodes={},this._adjacencyTable={}}return Object(j.a)(t,[{key:"addNode",value:function(t,e){if(t in this._nodes)throw new Error("Conflicting node id");this._nodes[t]=new m(t,e)}},{key:"addArc",value:function(t,e){this._adjacencyTable[t]||(this._adjacencyTable[t]={}),this._adjacencyTable[t][e]=!0}},{key:"getNodes",value:function(){return this._nodes}},{key:"getArcs",value:function(){return Object.entries(this._adjacencyTable).map((function(t){var e=Object(b.a)(t,2),n=e[0],i=e[1];return Object.entries(i).filter((function(t){return Object(b.a)(t,2)[1]})).map((function(t){var e=Object(b.a)(t,1)[0];return[n,e]}))})).flat()}}]),t}(),A=function(){function t(e,n){Object(v.a)(this,t),this.id=void 0,this.position=void 0,this.id=e,this.position=n}return Object(j.a)(t,[{key:"toString",value:function(){return this.id}}]),t}();function C(t,e){return(e+t*e)/2}function D(t,e){return(2*t-e)/e}function M(t){return{x:C(t.x,window.innerWidth),y:C(t.y,window.innerHeight)}}function N(t){return{x:D(t.x,window.innerWidth),y:D(t.y,window.innerHeight)}}function S(){var t=Object(a.useState)({}),e=Object(b.a)(t,2),n=e[0],c=e[1],o=Object(a.useState)({}),r=Object(b.a)(o,2),j=r[0],v=r[1],f=Object(a.useState)({}),h=Object(b.a)(f,2),p=h[0],g=h[1],m=Object(a.useState)(void 0),C=Object(b.a)(m,2),D=C[0],S=C[1],_=Object(a.useState)(void 0),T=Object(b.a)(_,2),B=T[0],E=T[1],I=Object(a.useState)(10),L=(Object(b.a)(I,1)[0],Object(a.useState)(void 0)),P=Object(b.a)(L,2),Q=P[0],U=P[1],W=new w;Object.values(n).forEach((function(t){W.addNode(t.id,new A(t.id,t.position))}));for(var X=0,H=Object.entries(j);X<H.length;X++)for(var J=Object(b.a)(H[X],2),R=J[0],Y=J[1],q=0,F=Object.entries(Y);q<F.length;q++){var G=Object(b.a)(F[q],1)[0];W.addArc(R,G)}var z=Object(a.useCallback)((function(t,e){e.preventDefault();var n=N({x:e.clientX,y:e.clientY});c((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},t,{id:t,position:n}))}))}),[c]),K=Object(a.useCallback)((function(t){c((function(e){var n={id:""+Object.keys(e).length,position:N({x:t.clientX,y:t.clientY})};return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},n.id,n))}))}),[c]),V=Q?function(t){t!==Q&&v((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(d.a)({},Q,Object(l.a)(Object(l.a)({},e[Q]),{},Object(d.a)({},t,Math.round(8*Math.random())+2))))})),U(void 0)}:U,Z=D&&B?function(){new Promise((function(t){t(function(t,e,n){var i={},a=Object.keys(n).reduce((function(t,e){for(var i=0,a=Object.keys(n[e]);i<a.length;i++){var c=a[i];t[c]||(t[c]={}),t[e]||(t[e]={}),t[e][c]=n[e][c],t[c][e]=-t[e][c]}return t}),{});function c(t,n,o){var r=[].concat(Object(O.a)(n),[t]);if(t===e)return{visited:r,increase:o};for(var s=null,u=function(){var e,a,u=Object(b.a)(l[d],2),j=u[0],v=u[1];if(n.find((function(t){return t===j})))return"continue";var f=null!==(e=null===(a=i[t])||void 0===a?void 0:a[j])&&void 0!==e?e:0,O=v>=0?v-f:f;return O>0&&(s=c(j,r,Math.min(o,O)))?"break":void 0},d=0,l=Object.entries(null!==(j=a[t])&&void 0!==j?j:{});d<l.length;d++){var j,v=u();if("continue"!==v&&"break"===v)break}return s}for(var o=c(t,[],1/0);o;){for(var r,s=null===(r=o)||void 0===r?void 0:r.visited,u=0;u<s.length-1;u++){var d=[s[u],s[u+1]],l=d[0],j=d[1];i[l]||(i[l]={});var v=!!n[l][j],f=o.increase*(v?1:-1),h=v?[l,j]:[j,l],p=Object(b.a)(h,2),x=p[0],g=p[1];i[x][g]?i[x][g]+=f:i[x][g]=f}o=c(t,[],1/0)}return i}(D,B,j))})).then(g)}:void 0,$=Q?function(){D===Q&&S(void 0),B===Q&&E(void 0),U(void 0);j[Q];for(var t=Object(s.a)(j,[Q].map(u.a)),e=0,i=Object.values(t);e<i.length;e++){delete i[e][Q]}v(t);n[Q];var a=Object(s.a)(n,[Q].map(u.a));c(a)}:void 0,tt=Q&&Q!==B?function(){S(Q===D?void 0:Q),U(void 0)}:void 0,et=Q&&Q!==D?function(){E(Q===B?void 0:Q),U(void 0)}:void 0,nt=k(),it=W.getNodes();return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("header",{children:[Object(i.jsx)("button",{onClick:Z,disabled:!Z,children:"Run"}),Object(i.jsx)("button",{onClick:$,disabled:!$,children:"Delete"}),Object(i.jsxs)("button",{onClick:tt,disabled:!tt,children:[Q===D?"Unm":"M","ark as source"]}),Object(i.jsxs)("button",{onClick:et,disabled:!et,children:[Q===B?"Unm":"M","ark as sink"]})]}),Object(i.jsxs)("div",{onClick:K,className:nt.canvas,children:[Object.values(it).map((function(t){var e=t.value;return Object(i.jsx)(y,Object(l.a)(Object(l.a)({onDrag:function(t){return z(e.id,t)},onClick:V},e),{},{position:M(e.position),bgColor:e.id===Q?"red":void 0,label:B===e.id?"sink":D===e.id?"source":void 0}),e.id)})),W.getArcs().map((function(t){var e,n=Object(b.a)(t,2),a=n[0],c=n[1];return Object(i.jsx)(x,{flow:(null===(e=p[a])||void 0===e?void 0:e[c])||0,capacity:j[a][c],start:M(it[a].value.position),end:M(it[c].value.position)},a+"-"+c)}))]})]})}var _=function(){return Object(i.jsx)(S,{})};document.addEventListener("dragover",(function(t){t.preventDefault()}),!1),r.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(_,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.515f54f7.chunk.js.map